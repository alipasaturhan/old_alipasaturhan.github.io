<html>
	<head>
		<title>Shell Link (.lnk) Binary File Format [0x01]</title>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="..\styles\styles_topics.css">
	</head>
	<body style="background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('..\\images\\16_10_2022\\bg.jpg');">
		<br><br><br><br><br>
		<center>
		<div class="topic_subject" name="topic_subject">
			Shell Link (.lnk) Binary File Format [0x01]
		</div></center>
		<br><br><br>
		<div style="margin-top: 55px;height:2px;width:100%; background-color:white" class="hr" name="hr"></div>
			<div style="background-color: #101010; padding: 10px">
				<div class="topic_content" name="topic_content">
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify">
						SHELL_LINK
					</p>
					<p align="justify">
						Shell Link Binary Dosya Formatı aşağıda gösterildiği gibi bir dizi yapıdan oluşur
					</p>
					<p align="justify">
						<code class="p_code" name="p_code">SHELL_LINK</code> = <code class="p_code" name="p_code">SHELL_LINK_HEADER</code> <code class="p_code" name="p_code">[LINKTARGET_IDLIST]</code> <code class="p_code" name="p_code">[LINKINFO]</code> <code class="p_code" name="p_code">[STRING_DATA]</code> <code class="p_code" name="p_code">*EXTRA_DATA</code>
					</p>
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify">
						ShellLinkHeader
					</p>
					<p align="justify">
						Lnk dosyasının en önemli header'larından birisidir. Optional değildir. Yani herhangi bir parser yazmak isterseniz, flagler'i kontrol ettirmeden direkt olarak offset değerlerinden belli bölümlerini parse edebilirsiniz. Peki nedir bu flagler?? okumaya devam edin :)
					</p>
					<p align="justify">

						<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&title=lnk_shelllinkheader2.drawio#R7Z1rd6JKFoZ%2FTdaa%2BdC9uIMfjZeOpxPjqOmkz5deRIkyQXCQJOb8%2BqkSMBZsL0lbVXTcca1uhVK06uFl77cunOmN2fJb7M6nV9HYC840Zbw805tnmqYqukP%2Bo1te0y2mWks3TGJ%2FnBV62zDw%2F%2FHyd2Zbn%2Fyxt2AKJlEUJP6c3TiKwtAbJcw2N46jF7bYQxSwR527E6%2B0YTByg%2FLWW3%2BcTNOtjma%2Fbb%2Fw%2FMk0P7JqZb%2Fv3h09TuLoKcyOd6bpyuov3T1z88%2FKNiym7jh62dikt870RhxFSfpstmx4Aa3bvNrS97W37F1%2F79gLk0Pe8M9r%2F%2B66cT%2B%2FVX4sbu6bz4NgcvlFVY30c57d4MnLf8jq6yaveRV5Y1Jj2csoTqbRJArdoPW29XxVDR49kEJevZW5jKI52aiSjf%2F1kuQ1a373KYnIpmkyC7K9iySOHr1GFETx6ph6e%2FVH9pR%2FZvbLF9FTPPJ2%2FDYna6jEjSdesrMS9LQk%2FaEbx8jq8ZsXzbwkfiUFYi9wE%2F%2BZRcfNCJysy721AnmSNQTcKNfaPy9332rhj3rjoac8vlz99e3qiyqjBUj1xq939P1fzfzlz819zWX24emr1%2ByVqJYDa0o7drtlb%2B1FPvnOmpKrXP6Fco1T2E9Iv2f2pkLjr7%2FFQTzsrA7mHLUCUjHnD9Hqe76hYv3vKcp3fFmsGrtOCqjGfLlqknw%2FVWw3cb%2Bk5eIR8%2BZpklD1rdNforVpkcXXSRRNAs%2Bd%2B4uvo2hGNo8WpEj7wZ35Aa2WTkgUehGRenaZozy4I%2FabbSloTej%2FF5479uIVpNkvzL5AXqB0arDgv0z9xBvM02O%2BkCvWoTLz4AfBxnZl9cjqcbO8TR%2B74H724sRb7qQx22uxUFkZVC9vVyHNyLZNN65AhrId30NlB5bB9U%2F4fNeCmnbotSC%2FXIu%2FFuz84httcumHj43LQaf5e%2BcCJbsNnb3prkFepakYaCaVA5MKgrlNEsxUFEjRXBbIU%2Bij05YnoUe1z0hVkX9K6pU4JavOyseFYd3GByjD0aON32Mj%2F%2BYFaWgH7mSB0sBZGgyB0gCGvoYtJUtY%2BsndxvOfbwkDefWWItAXeYawkVmsk4mN9%2B3ILVavel7skyrzYo4Jh6rk1sO%2BjMNwxKQcuqMwwNnqYTlHPY7d141ic1pgseM4JnscTSm4CHvK20XXoVDeyA0GuDx5kn7joyZM6%2BbckMa2H3j1JIn9%2B6fEQ33krY%2BO9NBJKUfOjdgj52QUDomgIAF8CVj7nhIJKAfP9dHIWyyw%2FQW0v3w%2FQyl727cxaVZsfv7Nr8vPnRUTDAJoDeL1n3fzi8yPtjS%2FVWr%2BDqnODmnmJTY%2F5%2BYXGf7BPUO1UhtXPz1mOt7e0mFxHW%2BqkrkK%2B3veMnE9ch787vRVY8EzjD3pa6G8qe4uX%2Br5U4Wkr3ZJugbT6KURzWZuOEbx4itehsjMBTy5TDkjADLxUj4iXqp86XIOlS4%2BFt57pcssUOfsVqJCcWuP0BWFq1Cel3A5JeG6iJLv3itqFmfNkp9tq1BXJTNKpVoDTj40aCYdhKIsjQaX8SnvQI5Fq6XQB4CiSR%2FHQU4vSIpdRm49emITOY0bcvknnwJyikI7HdUvdIRp%2Bk8jf5b%2BGZZsJA9TwVaTPvggqaqADDqcmITHbpoyQ7eP5Z1n7%2BqU5RK8adqBwZuqHjt4%2B00JKvcyfVYJunAXdHzJcNVEnealv0hkK478i6BqAoqjCFUcCxXnI4pjHKo4WiXSRavgXKl78sVieU3IwAsNmk7yqeWwEz5EKIMqkAwIlsE%2FcDxcFWTQPFQGpc2R2v3FT0Npuu6Mz4yYP0tlarJVZj2ZE1XmXSpjSVOZLdGRUoiOBE%2FpW9fIachXP2utHp0UffIypkEulVgZk9rB%2BOfK2KGjI6TJmKF81Tb%2B8qBYmKqVBy58YlW7jeJHP5w0%2FRg1jXy67AQw9x5Q1N4naoeOm6hcBlgebPCJxaYeT55m3soiPHmtke65o9R8TGoOXddFWvxkK1%2BVjb%2FCB3IPn%2FYu9PKZFI2Oxr%2BMRqsZeShq0HAabqIG46efznCazuIm9EfRGE1VTRNpqm4BD1p46HOC147INbIbYc%2FheqqQSDNsC37ayeBHLrut5XyQxH44QfZ0kabFFvZOZ9R0%2FynshAOPtKCbeL04ojPxkUFdZDK7hcHTGbRzEz4tvLGK2OkVSDdOagRH041f%2FJAu2njy6FUg4Tid3ndy1a0vbhYe9lFpRgVSjZPqICWpBjX5kDyjAonG6fSWdaOePw7qge9ifqEZFcgvtndrLOZuuL2tc5hoa7Nzs7dF9tpGg6effXoNLj%2ByN06nI4GEV7d%2BMh1M%2Fdml%2B4pRFuFPfnhvnGR%2FwjB2R4%2FInyk%2FyjdOp0OhFbr3gZfOCb7yEnecfvSpMyg%2F3jdOp2Oh6S8ohFQD6QSDlQ5i%2FxbFUH7sb5xO30KG4fcwegnbUTD2YiRxTWIFkpLT6W4ok4hmSIphBXKT0%2Bl6uAldit11OHCfcaCdZlUgKDyd7ode7D14cSt89uMopBMncO7pCsIKhISn0xPx3fPmdIh7kC6X1Y7im24jTZYRRUt%2BTGiejlFYD4LoZWUTrsxCxM%2BSPwt%2FK3xbu8VGad3Qlo4n9%2F%2FS6IRrcnBl88m%2FM6be24NWIH8vapq6BbX8g%2B7zDYMpqQ1KXXp75w327ovvKfF4WHceYSBhWWTZC6PQK%2BCVbSIh6iQkL0eELHqPwXNKlE8ku57tmPnj8Wr%2BHgQ%2Fe3ocgVK1sM43AKkFMKrzYlQtK2R5Ecjf1YxKr%2B3NKlXbpA9AqVZ%2Fx2HAMvavMQmutMzthgRqWareZrBg63NtfQ24k5bg1i93JaQzSJqr8ATbn2%2F7yz%2F7yx5%2Ba5nELja%2FgOaHbqQntvmBlRYHt78GF9e33ev%2BVf3ykyMg%2Fd4eZj5RYt%2B9PbgFgcBidRkBV%2FW7zlXn71YTIeAMgSUdAuCmZBkEnW73ut4Ydn60EAPOGNRkY7Be4%2B0PujmZ8pW9Pdne1W9Wr3pe7JM6o6bAMZbE2XkvsgNWoc80WPIy9Dlraw%2FX3CRqX%2FHa3tszGrvKn%2F3uovU722AzuY1ezl8TvEk0ZzWzgLuWgbEtNzUDln5ody5bv%2BrDYb9zfjNs%2Feq36s3r7uVPZOHILJjsqW4fegc7fiyUbY4CCxedZrPVRRI4kwAN0hFLQtnwKJAw%2BDkYtq6QBL4kOIfeiZcfCWXvo%2B8tvPh5tYgEtj7X1oeGqoht%2FbLvUdCBZqffagyv%2Bxge8IbBkQ5D2f8owFDvNy7QAzk%2BCiQNrFqoWE4Z88uChs3Pu%2Fnlx4flCe0FKcCeESEoyA8QganuBRRIntC77tcxROBPg%2FSAEZh4Xkwce%2FX%2BoPWLbkUeePMgPWYEJoKX7MUUiN51pztEIo6dROhVixyBadkFIhrXV71%2BazDAPnX%2BOEiPJIHp0QUcrtvty04XLxa8WahAKFn2GktZxZDIQ3fY6g5%2FdbrN1h1qBH8u5AeVe13IVrfR%2F9kbIg38aZAfUkKzJwutvpi6c%2Fp09BQHr%2Bd0EQo6tmRf87%2BxsoIh8OcX6z1Jepcevfml9sGhMIfXuaGwdQ6vF1yucpvfrQX1ch1X%2Fn5flR3zlA9wPmDMU8a65DFP69tEHDjoqVjeVnaPenKU3yu%2Fb1SVVZMwqsooe6QX5FzFYVUcrlJqcWqr9HFVZjnNVZbkaLQx8umiyubM0T%2BbCL1qRBR6T1UFmEUCzSPldgk1y4muslRYIJAHUTzUgDBWLA7lXJfog8rgoCIP4vQBcD%2FEAlFOcgkQOgOEjkCIAwIIIcQCUR5uQ4DQGCA0BEIcEIZsIMrGBwHCYIAwEAhxQMiOIfKDsUCYDBAmAiEMCFV2jmGBSafNAGEjEPxsCLVqWacFZZ26xRBhIRHCiJCed1pg3ukwQDgIhECJkJ14WlDiabBORB2JEEiE7MzTAjPPGkNEDYkQSITs1NOCUk%2BD9SLQvRZJhPQ4oty7SYhg7coGEiGOCOnJpw25EQbrRrSQCH5E2FVLPu3yZBBCBGtYNpEIYURITz5tDQKCdSPaCIRAiZCdfNqQY2mwdsQFEiGQCNnJpw05lgbrYX9DIgQSITv5tCHL0mDtiA4SIZAI6XEEaFnWGSL%2BQiLEESE%2F%2BYQsS6PBEHGJRPCbea5XLvkELctzhojvSIQwIuQnn6Bj2WKAuEIgBEqE7OTTgRxLkx2Sf41ECCRCdvLpgI5lmyGii0QIJEJ28ulAlqXJjo7oIRECiZAdRziQZWmyfeH%2FQSLEESE9%2BXQgy9Jk%2B8IHSISwZc%2FkJ58OZFkWiOgjEcKIkJ58OpBjabJd4UMEQqBESE8%2BIcfSZPvCfyARAomQnnxCjqXJDqC6QSIEEiE9%2BYQsS5PtC79FIgQSITuOqIGWJTte5g6JEEeE9OSzBlmWJtsX%2FjcSwY0IvXIrDdVAy5IdL%2FMTiRBGhPTkswY5ljbbz9XGxYZEaoTs7LMGWZY2a2K3cbkhkUjITj9rkGdpsz1dbQ2REIiE7PyzBrmWNmtjt3HJIZFISI8lINvSZo3sNi46JBAJ%2BRko5FvahVlduOwQPySMyi07VIOMS5u1stu47pA4JKTnoGuVYpFgvew2rjwkUiVkJ6GqAnmXdq1gTCgIhUAoZKehBEsICraLo43LD4lkQnYeqiqgg1kvCAVamCKhkB9RgB7meQEKdKwEQiE9F1UV0MVsFqBAz4ojFJVbh4gENRAUjQIU2N0hDooK5KOgkdkqMIFOpkihkJ%2BQQlamU%2BwpRy9TJBTyE1LQzGwXoEA3UyQU0jNSFbIznUJvuYp%2BpkgopMcUKuRnOoVRNSp6VwKhkJ%2BRqpCf6RR6zDX0rvhBUbyHeQUyUhUyNJ3CyBoNez7EQSE%2FI1UhP9MpdJpr6GeKFArpGakK%2BZlOodtcQz9TJBTSM1IV8jOdwogrDf1MkVDIz0ghQ7PGelddXANTJBPyQwrIz6yxLsUAmRDIRAXyUcjOVApMXHTan2g5EqNqWFil0RT5JX0DCxXiQufGhQY5mgp7%2FUAkhCEB5aOiiYDsTIW1MxvD%2Fie6flSeClUxdelYQIamwhqa9Uu8fIikoiZfLMo5aandF1N3Tp%2BOnuLg9Tx2R49esh%2BAN1pWOAT%2B%2FGK9J3ETPwrJS7oyyq5WOkKt64Vat4FQTgPq3DT4VXo5vv9klW45bKU7AOlQpa%2Fpf0elk5dxRBVrve8bqZfpVTT2aIn%2FAw%3D%3D"></iframe>

					</p>
					<p align="justify">
						<b>HeaderSize[4]: </b>ShellLinkHeader yapısının boyutudur. Değeri 0x0000004C olmak zorundadır. Çünkü yapıdaki tüm elemanların boyutu 76 byte'dır (şansa ascii: L olması çok garip değil mi?? :)).
					</p>
					<p align="justify">
						<b>LinkCLSID[16]: </b>Dosyanın kimlik numarası gibi düşünülebilir. Değeri 00021401-0000-0000-C000-000000000046 olmak zorundadır.
					</p>
					<p align="justify">
						<i>CLSID veya Sınıf Tanımlayıcı, bir dize veya alphanumeric (Hem harf hemde Sayısal) bir simge dizesidir ve genellikle Windos Bileşeni Nesne Modeli veya COM tabanlı bir programın belirli örneğini temsil eder.</i>
					</p>
					<p align="justify">
						<b>LinkFlags[4]: </b>Shell Link hakkında bilgileri barındırır. Tüm flaglara bakmak için <a href="#LINK_FLAGS"><code class="p_code" name="p_code">LINK_FLAGS</code></a> başlığına bakın.
					</p>
					<p align="justify">
						<b>FileAttributes[4]: </b>FileAttributesFlags yapısındaki bitleri tutar. Bu bitler hedefinin dosya özniteliklerini belirten bitleri tanımlar. <a href="#FILE_ATTRIBUTE_FLAGS"><code class="p_code" name="p_code">FileAttributesFlags</code></a>, bağlantı hedefi mevcut değilse veya hedefe erişim verimsiz olacaksa kullanılabilir.
					</p>
					<p align="justify">
						<b>CreationTime[8]: </b>UTC olarak bağlantı hedefinin oluşturulma zamanını belirten bir FILETIME yapısından türer. Değeri sıfırsa, bağlantı hedefinde oluşturulma zamanı ayarlanmamıştır.
					</p>
					<p align="justify">
						<b>AccessTime[8]: </b>UTC olarak bağlantı hedefinin erişim zamanını belirten bir FILETIME yapısından türer. Değeri sıfırsa, bağlantı hedefinde ayarlanan erişim zamanı ayarlanmamıştır.
					</p>
					<p align="justify">
						<b>WriteTime[8]: </b>UTC olarak bağlantı hedefinin yazma zamanını belirten bir FILETIME yapısından türer. Değeri sıfırsa, bağlantı hedefinde ayarlanan yazma süresi yoktur.
					</p>
					<p align="justify">
						<b>FileSize[4]: </b>32-bit işaretsiz tamsayı yapısına olan bu üyemiz, byte olarak hedef dosyanın boyutunu tutar. Bağlantı hedef dosyası 0xFFFFFFFF'den büyükse, bu değer hedef dosya boyutunun en az anlamlı 32 bitini belirtir.
					</p>
					<p align="justify">
						<b>IconIndex[4]: </b>32-bit işaretli tamsayı yapısı olan bu üye, verilen iconun hangi index'te olduğunu belirtir. Peki nedir bu index? Çalıştırılabilir dosyaların (EXE, DLL gibi) kaynağında icon dosyaları gömülü bulunabilir. Hatta bir tane çalıştırılabilir dosyada birden fazla icon dosyası da bulunabilir (embeded icon in program resource). Lnk dosyası ise, hedef dosyadaki kaynakta hangi icon dosyasını kullanacağını bu index ile belirtir.
					</p>
					<p align="justify">
						Örnek olması açısından "010 Editor" adlı uygulamanın icon index'ine bakalım...
					</p>
					<p align="justify">
						<img style="width: 75%" src="..\images\16_10_2022\10.png">
					</p>
					<p align="justify">
						Daha sonra "010 Editor" programının resource segmentinde neler olduğuna bakıp hangi icon dosyasını kullanacağına bakalım.
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\09.png" style="width: 75%">
					</p>
					<p align="justify">
						Icon index 0 olduğundan ilk icon'u kullanacak, yani yukarıdaki resimde gösterilen icon dosyasını (Neden farklı boyutlarda aynı icon var? Windows kendi içinde sembolleri küçültüp büyüttüğümüzde değişen scale için ugun boyuttaki icon dosyasını buradan bulup seçer). 
					</p>
					<p align="justify">
						<b>ShowCommand[4]: </b>32-bit işaretsiz tamsayı yapısında olan bu üyemiz, link tarafından başlatılan bir uygulamanın pencere durumunu belirtir. Buraya gelebilecek değerleri görmek için <a href="#SHOW_COMMAND_VALUES" <code class="p_code" name="p_code">SHOW_COMMAND_VALUES</code></a> başlığına gidiniz.
					</p>
					<p align="justify">
						<b>HotKey[2]: </b>Kısayol tuşları ile başlatılan uygulamanın hangi tuşları kullandığını belirtir. Hangi tuş hangi değeri taşıdığını görmek için <a href="#HOTKEY_FLAGS"><code class="p_code" name="p_code">HOTKEY_FLAGS</code></a> başlığına bakınız.
					</p>
					<p>
						<b>Reserved1[2]: </b>Bu kısım 0x0000 olmalıdır.
					</p>
						<b>Reserved2[4]: </b>Bu kısım 0x00000000 olmalıdır.
					</p>
						<b>Reserved3[4]: </b>Bu kısım 0x00000000 olmalıdır.
					</p>
					<p align="justify">
						Örnek olması açısından yukarıda bahsettiğimi parser'ı kendim yazmaya karar verdim. Aşağı kısımlarda lnk_parser.py kodunu ve çıktısını görebilirsiniz.
					</p>
					<p>
						<div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .1em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #cd00cd">import</span> <span style="color: #cccccc">binascii</span>

<span style="color: #cd0000">&quot;&quot;&quot;</span>
<span style="color: #cd0000">LINK_FLAGS = {}</span>
<span style="color: #cd0000">FILE_ATTRIBUTE_FLAGS = {}</span>
<span style="color: #cd0000">SHOW_COMMAND_VALUES = {}</span>
<span style="color: #cd0000">HOTKEY_FLAGS = {}</span>
<span style="color: #cd0000">&quot;&quot;&quot;</span>

<span style="color: #cccccc">SHELL_LINK_HEADER</span> <span style="color: #3399cc">=</span> <span style="color: #cccccc">{</span><span style="color: #cd0000">&quot;HEADER_SIZE&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span> <span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;LINK_CLSID&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x10</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;LINK_FLAGS&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;FILE_ATTRIBUTES&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;CREATION_TIME&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x8</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;ACCESS_TIME&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x8</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;WRITE_TIME&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x8</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;FILE_SIZE&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;ICON_INDEX&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;SHOW_COMMAND&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;HOT_KEY&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x2</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;RESERVED_1&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x2</span><span style="color: #cccccc">],</span>    
                     <span style="color: #cd0000">&quot;RESERVED_2&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">],</span>
                     <span style="color: #cd0000">&quot;RESERVED_3&quot;</span><span style="color: #cccccc">:[</span><span style="color: #cd00cd">0x0</span><span style="color: #cccccc">,</span><span style="color: #cd00cd">0x4</span><span style="color: #cccccc">]}</span>

<span style="color: #cdcd00">def</span> <span style="color: #cccccc">read_bytes(file_path):</span>
    <span style="color: #cdcd00">with</span> <span style="color: #cd00cd">open</span><span style="color: #cccccc">(file_path,</span> <span style="color: #cd0000">&quot;rb&quot;</span><span style="color: #cccccc">)</span> <span style="color: #cdcd00">as</span> <span style="color: #cd00cd">file</span><span style="color: #cccccc">:</span>
        <span style="color: #cdcd00">return</span> <span style="color: #cd00cd">file</span><span style="color: #3399cc">.</span><span style="color: #cccccc">read()</span>

<span style="color: #cdcd00">def</span> <span style="color: #cccccc">parse_bytes(file_bytes):</span>
    <span style="color: #cccccc">cursor</span> <span style="color: #3399cc">=</span> <span style="color: #cd00cd">0</span>
    <span style="color: #cdcd00">for</span> <span style="color: #cccccc">i</span> <span style="color: #cdcd00">in</span> <span style="color: #cccccc">SHELL_LINK_HEADER:</span>
        <span style="color: #cccccc">SHELL_LINK_HEADER[i][</span><span style="color: #cd00cd">0</span><span style="color: #cccccc">]</span><span style="color: #3399cc">=</span><span style="color: #cccccc">file_bytes[cursor:cursor</span><span style="color: #3399cc">+</span><span style="color: #cccccc">SHELL_LINK_HEADER[i][</span><span style="color: #3399cc">-</span><span style="color: #cd00cd">1</span><span style="color: #cccccc">]]</span> 
        <span style="color: #cccccc">cursor</span> <span style="color: #3399cc">+=</span> <span style="color: #cccccc">SHELL_LINK_HEADER[i][</span><span style="color: #3399cc">-</span><span style="color: #cd00cd">1</span><span style="color: #cccccc">]</span>

    <span style="color: #cdcd00">return</span> <span style="color: #cccccc">SHELL_LINK_HEADER</span>

<span style="color: #cdcd00">def</span> <span style="color: #cccccc">pretty_print(dispersed_data):</span>
    <span style="color: #cdcd00">for</span> <span style="color: #cccccc">data</span> <span style="color: #cdcd00">in</span> <span style="color: #cccccc">dispersed_data:</span>
        <span style="color: #cdcd00">print</span><span style="color: #cccccc">(data</span><span style="color: #3399cc">+</span><span style="color: #cd0000">&quot;[&quot;</span><span style="color: #3399cc">+</span><span style="color: #cd00cd">str</span><span style="color: #cccccc">(dispersed_data[data][</span><span style="color: #3399cc">-</span><span style="color: #cd00cd">1</span><span style="color: #cccccc">])</span><span style="color: #3399cc">+</span><span style="color: #cd0000">&quot;]&quot;</span><span style="color: #cccccc">,</span><span style="color: #cd0000">&quot;:&quot;</span><span style="color: #cccccc">,binascii</span><span style="color: #3399cc">.</span><span style="color: #cccccc">hexlify(dispersed_data[data][</span><span style="color: #cd00cd">0</span><span style="color: #cccccc">],</span> <span style="color: #cd0000">&quot; &quot;</span><span style="color: #cccccc">)</span><span style="color: #3399cc">.</span><span style="color: #cccccc">decode(</span><span style="color: #cd0000">&#39;ascii&#39;</span><span style="color: #cccccc">)</span><span style="color: #3399cc">.</span><span style="color: #cccccc">upper())</span>

<span style="color: #cccccc">pretty_print(parse_bytes(read_bytes(</span><span style="color: #cd00cd">input</span><span style="color: #cccccc">(</span><span style="color: #cd0000">&quot;File Path&gt; &quot;</span><span style="color: #cccccc">))))</span>
</pre></div>

					</p>
					<p align="justify">
						Yukarıdaki python script ile bir lnk dosyasını parse etmek istediğimizde aşağıdaki gibi bir output alabiliriz.
					</p>
					<p align="justify">
						<img style="width: 75%" src="..\images\16_10_2022\08.png">
					</p>
					<p align="justify">
						Bu script'i referans alarak konunun ilerisindeki yazıları okuduktan sonra, flag'leri kontrol ettirerek tüm lnk dosyasını parse edebilen bir script yazabilirsiniz.
					</p>
					<p align="justify">
						Script kaynak kodu: <b><a href="https://github.com/alipasaturhan/Shell-Link-Parser" style="text-decoration: none;">lnk_parser.py</a></b>
					</p>
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify">
						LinkTargetIDList
					</p>
					<p align="justify">
						Lnk dosyasının hedefini belirtir. Bu yapı <code class="p_code" name="p_code">LINK_FLAGS</code> yapısından <code class="p_code" name="p_code">HasLinkTargetIDList</code> bitine bağlıdır. Eğer set edilmişse kullanılır, 0 ise kullanılmaz (yani isteğe bağlıdır). Bu yapının açıklamaya gerek duymadığım bir structure'ı var. Fakat ben size naçizane diyagramlarımla kısaca bahsetmeye çalışayım. Bu yapının tamamını görmek isteyen varsa <a href ="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">MS-SHELLINK</a> official döküman pdf'ini bıraktım.
					</p>
					<p align="justify">
						<!--<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7Zxbb5swAIV%2FTaTtIRXYhKSPa9J21VpNWrR1b5MTXEAxMQPn1l8%2FAyaB0kqTdjurSR4Cxxd8%2BYhOjiIGdJrsrzOWRncy4GJAnGA%2FoLMBIa5DJ%2FqjUA6VMnLPKyHM4sBUOgnz%2BJHXLY26iQOetyoqKYWK07a4lOs1X6qWxrJM7trVHqRoXzVlIe8I8yUTXfU%2BDlRUqRMyPunveRxG9ZVd38xvwZarMJObtbnegFCnfFXFCav7MkIesUDuGhK9HNBpJqWqjpL9lItibetlq9pdvVB6HHfG1%2BpnGjwePn39OF2k986X%2FPNitp2L8HY4MZPZMrHh9Tx8oTu8eJC6X72gbFkV%2BN83xVAvbtZ6K3IpmGInUR%2BF5rNsnKdsXcxZHUS7ddHrMC8peKcruF66r5o96cipe9ITqjprX0DL1QBrmbQuR8qN4cXUHV28i2LF52k1lZ0GWWuRSoQ%2Bc4vRqkyu%2BFQKmZWt6VX5KoYbC9HQnfJtptGsPy7ex3E0N8Xs05Zniu8bktmkay4TrrKDrmJKz72qRX0%2FkVF1vjvRWSMVNcD0jMbM%2FRAeOz4xoQ8MFs8jcvdh5spEJatvD1d%2BsMhXl8PHoQtKiPs%2FE9LB4RloXiTEdcEQIaCIEHsRoWCIUFBEqL2IjMAQ8UAR8exFZAyGyAgUkZG9iKDZVR8UEd9aRAiaXR2DIjK2FxE0uzoBRWRiLyJodhU1OTu3FxE0u1pn3HCMHLOzRfYqAtdfwwbNwhJ4bKxjhKJ5WIIay9ubuVI0E0tQc3l7Q1eK5mIJajBvb%2BpK0WwsQU3m7Y1dKZxnRY3m7c1dPTjPiprN2xu8enCeFTWctzd59eA8K2o6b2%2F06sF5VtR4%2FjiMPnrV249mY2kfvaIxMkKzsbSPXuEYQbOxtI9e4RhBs7G0j17hGEGzsbSPXuEYgfOsffSKxogP51n76BWOETjP2kevcIzAedY%2BeoVjBM6zokavx9%2B%2BffSqsUGzsV4fvaIxMkazsV43er2Z3ca5Kp8r83oW%2Fum96XfXnf7dhe%2FmmdXCa%2B3NlmUxWwj%2B9hXtQOfPM%2F9%2BC7px4dnZGcqSF7p5uJP%2BkvgTN4HvdHfA937PDujT04OYyrLG067o5Q8%3D"></iframe>-->

						<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7Vptd5owFP41nG0f2gMCaj%2B2irVnbO1q15d9ixIhMxAW4lt%2F%2FRIIAkU9nq2Ic8I5Sp6bhHDv89yQqKJ3%2FMU1BaH3hTgQKw3VWSh6V2k0zAudfwpgmQC6LgGXIieBtAwYoFcoQVWiU%2BTAqFCREYIZCovgiAQBHLECBigl82K1McHFu4bAhSVgMAK4jD4hh3kJ2m60MrwPkeuld9aaF4llCEYTl5JpIO%2BnNHQ1PhKzD9K%2BJBB5wCHzHKRbit6hhLDkyl90IBauTd2WtOttsK7GTWHAdmnwBK8f727vrm69O%2Bt%2B8uPhB%2F52cyafMmLL1B%2FQ4e6RRUKZR1wSAGxl6FX8zFD0qvJSVscmJOSgxsGfkLGljDWYMsIhj%2FlYWuECsWfR%2FNyUpZecpbuQPceFZVoIGF3mGoniS96WNYtLabsxCVgP%2BAgLoA%2FxDDI0AtwQMUomsEMwofGD6z1VnNySuET4YaOnJRSRKR3JWq%2FL%2B%2BfbzjB8Uh%2Bj78PubIBd%2B6wtucIAdSHbEgdtRQiuM0h8yJ%2BBt6MQA4ZmxYEAyXh3VS%2BLOr%2BQgV9Pgq2jnAE8hSmZm5gJL4UgKPCj%2BWsqCBv79SyKI3zJK2hGuIhdl9r5lSu%2BB33LtnkF%2B%2BbrZ%2F7Vty671n3aOx9tcoOkbomLRabNPcTgIASxx%2Bc8GRVZVQ5ofIixIoxzuBqf8hny9VviXI1jTbxnkDK4yEHliElro20mTdKs2JZZYJ7lGM2U6vNy%2BcVQ%2Fz7I6xlm1Cl1LSf0TPZ7kno%2Bzg4cg2lC7XdOAJt1vYv%2B9T0lgG2jrEL%2FUvc9%2B%2FJ68E%2FIvqTxNYHfWfaGYdYs%2B3Jqt5SOoVz0IBVhE47nxBRsR9hHSsfkpgie3gqqTAr6jknBqDUnNLcyRz0x54CZo5lb05R63tRkYtiZTLKzO4IClqtCxuOYBm%2FYtrrnnxNQr25S6oPIRsHkIXbjTddGETv%2BucloNw5sbkq3AE7ZoppsYeyYLTYkiz3NM%2B0TCQ6BBFqrThYYFa5Aypke%2BCJRB8MoTOodeeZ%2FuypparVvRmgl955E%2F46iN3cUfbNOzZvVaT5VuvpxBigCQww%2FHb%2FMV3uMqcxr33MsLyHfL8IM%2Bqco86uWWXeUtQpXaoV9wyFN4XN%2BlNHjD35pDafWvoarMIvbyU9GIAo%2BbHxry6K%2FaUX%2FP%2FPjAN70WlXP8vHr3tFHVkt%2FpN3D5M6L2d8Sku287K8fuvUb"></iframe>

					</p>
					<p align="justify">
						İlk başta flaglar kontrol edilerek TargetIDList set edilip edilmediği kontrol edilir. Eğer set edilmemişse bu lnk dosyasının LinkTargetIDList başlığı bulunmamakta. Eğer 1 set edilmişse:
					</p>
					<p align="justify">
						<b>IDListSize[2]: </b>Byte olarak IDList yapısının boyutunu tutar.
					</p>
					<p align="justify">
						<b>IDList[variable]: </b>IDList yapısını tutar. İçerisinde lnk dosyasının belirttiği hedef dosyanın path'ini part part tutar. Her partta hangi dizini/dosyayı göstereceğini ayrıntılı bir şekilde gösterir (variable denemsinin sebebi IDList yapısının birden fazla olabileceğini söyler. Çünkü şimdi berlittiğimiz gibi, path'i part part gösterir). Konunun daha iyi anlaşılması için aşağıya örnek parse edilmiş targetidlist yapısını ekledim:
					</p>
					<p align="justify">
						<img style="width: 75%" src="..\images\16_10_2022\03.PNG">
						<!--<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7Zxdb9owGIV%2FDdJ2QZXYSaCXK5QOrVWnsa3b1WSIIREOpon56q%2BfkziQlFbqTaejOXBB8vrb7%2BPocC7SoYNkf5OydXQnQy46xAn3HTrsEOI6tK9%2F8sihjPjuZRlYpHFoKp0Ck%2FiJVy1NdBOHPGtUVFIKFa%2BbwZlcrfhMNWIsTeWuWW0uRXPUNVvws8BkxsR59CEOVVRG%2B6R3in%2Fm8SKqRnYDs74pmy0XqdyszHgdQp3iUxYnrOrLBLKIhXJXC9HrDh2kUqryKtkPuMj3ttq2st3oldLjvFO%2BUm9p8HT49ut%2BMF0%2FOD%2BzH9PhdiIWt92%2BWcyWiQ2v1hEI3eHVXOp%2B9YayWVkQPG7yqV6NVzoVmRRMsVNQXy3Mb9E4W7NVvmZ1EM3Wea%2FdrKDgk67geut92exZR07Vk15Q2VlzAB0uJ1iFSWM4UiSG50t3dPEuihWfrMul7DTIOhapROg7N5%2BtSuWSD6SQadGajopPPt1YiFrcKb5mGfX6vfx7nEc9KSZPW54qvq%2BFTJJuuEy4Sg%2B6iim99MoW1Xkifnm%2FO9FZIRXVwPRMjJnzsDh2fGJCXxgsXkbk7svQlYlKln%2FmoyCcZsvr7lPXBSXEtZYQ1wVDhIAiQuxFhIIhQkERofYi4oMh4oEi4tmLSA8MER8UEd9eRNDkagCKSGAtIgRNrvZAEenZiwiaXO2DItK3FxE0uYrqnF3aiwiaXK08bjhGjt7ZNG0NVzjHlcBjYx0jFE3DElRb3l7PlaKJWILqy9trulI0FUtQjXl7XVeKJmMJqjNvr%2B1K4TQrqjVvr%2B%2FqwWlWVG%2FeXuPVg9OsqOa8vc6rB6dZUd15e61XD06zotrzx2m01qtOP5qMpa31isaIjyZjaWu9wjGCJmNpa73CMYImY2lrvcIxgiZjaWu9wjECp1lb6xWNkQBOs7bWKxwjcJq1tV7hGIHTrK31CscInGZFtV6P%2F31b61VjgyZjvdZ6RWOkhyZjvXNb7TtPk3jFxHj4H238s7MZeOf7Tv%2Ftxp97VWPFk%2FHwNs7yo%2Flhy9KYTQX%2FWH%2FGvuHQkVcOHUoy87h5aZFL3iW5fnCe3MB7p%2BRm3mi%2BCZ1hNvx97%2Bx59vVxef%2FC6zsuLi4AE6CfPlUCznb7hZy8%2BXQ575cAfXt6w1NRVnuNFr3%2BCw%3D%3D"></iframe>-->


					</p>
					<p align="justify">
						Daha detaylı bakmak isterseniz 010 Editör'ü kurun ve plugin olarak LNK parser template indirip inceleyebilirsiniz.
					</p>
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify">
						LinkInfo
					</p>
					<p align="justify">
						Bu kısmı anlatmaya çok üşendim gerçekten... (Anlatmaya gerçekten gerek duysaydım anlatırdım. İsteyen varsa <a href ="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">MS-SHELLINK</a>'ten okuyabilir) İleriki zamanlarda bu bölüm gelebilir. Takipte kalın :)
						<!--<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7V1Zc%2BI4EP41eUzKBwbySDgm1DCZ1DDZzD5tKbawtTEWK4trfv1KtgW%2BCGSCj2DhqgS3ZVvq%2FvRJrZbEld6fb74QsHC%2BYQu6V5piba70wZWmqYreZf%2B4ZBtKjK4eCmyCrCjRXjBFv6G4M5IukQX9REKKsUvRIik0sedBkyZkgBC8TiabYTf51gWwYUYwNYGblT4jizqhtKt19vJ7iGxHvFlt34ZXXoD5ahO89KL3XWm6EnzCy3MgnhUJfAdYeB0T6cMrvU8wpuG3%2BaYPXa5bobbwvtGBq7t8E%2BjRU274vf3x63v%2FZfGs%2FOU%2FvQxWU9eeXKtqK3zOCrhLKAoSZJduhYqgxTQWnWJCHWxjD7jDvfQuUAPkL1LY2T7NBOMFE6pM%2BC%2BkdBuZHywpZiKHzt3oqk8JfoV97GISvFMfBR92JVvMqOQ%2BXhITvlG2bmQoCogN6ZtKiCDLCxp7R6THLxDPISVbloBAF1C0SkIHRAi0d%2Bn2VmBfIkO8wygi4wmbtF1WhLsZZlqIG6f93xKLC9d%2BoN4eS6C2FptAeeI6r6GAguswHTETNzuU8trW49nWRjyJf2NjbLsQLJB%2FY%2BI5E5s%2BSzKagTlyeVUfe6xG%2BpjpAyTeMgNmMmcHErZt%2Fv8eAguSABZRCaMMiAQZMCahtnYQhdNF%2BM41Y6hTYTVDrhuTK8ER6TGevsOPt2C4goTCzZuoia62OhETREzZik7Xe9rZyZwY5QjZ2XGm7spweZX%2FVju18gt%2BrknlFxmP2WSCvNf%2BZDoefKwycGiP8qpveGkqVBqygWZwPjA4IxiHOMEIWYElFbzAvuY9OrQ8a2tqXiW71VdJvRZVsu5Y%2BXNiUEUH7QRm0GrFDLucp6hh5ALbl9RQMDXs2onquEHJNtcj5MIepQS9LCmUICgcBO3qQZDtH%2FQJZPSDvZ9oDiUECoaAplQPgWwfoWea0PclAMoAQPV%2Bm5IdtHkmzK7S%2FmXYv3onQTFyOwJchbIPULT99Rp0BNsZ%2B4%2BZPsfMzhtp%2F6LtX4M%2BYCdj%2F6mD1308nwPPkggofOC2egR0Mwi4x%2FQr3ErjF2386rt%2Fat4YYSI%2BVK9Qzx%2BFq8Lwj7Jp9QuJDL0Dc0lsDRV%2B5GDR4Md5MKeracLJQG43HBWHnFYY5MSTmwA5RdHUlqJe81h%2B%2BKcvvoWfVrtqSJ5Gg8MBP84DSdU4HinplgpJ4zaj7hICI0yDZPsrfvI3f9iNIU4Hm%2Bjh4dk2Oqt7y3oQIscDKiJMcjygYtRrnsUu5w1gtXvg81jRz8BG48EE%2BbRqEiu%2FXWVPS5BYbkxHKZXFhDMpWaxqFmudzGLGuVksuLVHCNjGEiwwYgqLPfmRC2ItcjcFZiM1%2F%2B9Y%2BlslBd8wB3sw74ryEYrNm1940RQ79mZYUqua5yaXTK1qRt%2BSWiuhVuNkam3Xg1pvU2DuHKHWVHrhsBdMrdko0AVT6wOYFzNH%2BHPRal7woVxa7VZDqxtEfwniZN9jpMrO9pzKTwSlSirOcka7Oir%2BoK%2BejXleMNv9iJT6yFcRSdbLG20sl%2FU6Xcl6n5f1Op%2BW9bKR%2FgtmvWdMXpFnDxCRnJc7z7RkzqsmwiI57yyc1%2F20nJed23LBnNcj9nIOg%2BGIxlNe9eGYbjXhGEl5Z6G8kxf8147yjq74vyTK43OVJ9gM1ixJ1stdT1Iu64kcNQB%2BY%2F%2FJQya25FiyplU%2FlqznbUBxmcAbYdZ6PWAZIX5zHVXJ8NMaAz%2FW7A43iyklyLMl9vTqB1f05kzi%2F7H0xt4UMgsCCh8J5kuVJQZz1xGWjMHmTM568pY%2BtFQJO70G7kajJq4MAFkjj2%2Fe1Xjo1cDhaM4sAtbq9vwnH8pYmqbXwNVoVCCXuRp8kE8iL3epeMnIa0447QE%2FIsvtuQhI%2F0Jr1cC%2FOBzW8BfAO2xrASZu7WQg6VDPXosZPHx28wxefc9e5KABXMO6V8%2BIOlMHzSdgK3tZDH%2FVd%2B9bjYwn%2FCTAfJX4a1Xfy281J6Aw9MCLC8P15N8gBVb46IZj0Ki%2Bv99qTmBhgHwOQs6BfKFEwIMyvsVhWH3fv9Wc2EIEw68eXnsj7FqQSCTukFgDp6Q54YYsEuVgSAjDGvgmzQk9PHmAw%2B67NwUrOdFOa9egU9ic8MMjgTNIht4KEezxlRVyDW0Awhp0CZsTifgK4YJPcXfDrdZGmDw99ENnWUKxXX2f0GjOQGHPdfE6GCYMBgsl%2FIzqxwmN7BhNdnfGjxqkzqu8UjAYGfzIgcGAH%2BeBwQl7P%2BZuqlzcPt5G1jHdLw%2BQ1i%2FU%2Bp3qrZ%2F1B8Pp%2BYOA%2B6X9i7R%2F3lLjsu2fdcmGG0qANH8J5q%2B%2B%2BnfyQoUpq8sfej1s%2B%2BPLwdtRBOLMm0lmdn%2FstI0kuIwUaML16NFdKdycYyPIdl6oJQWlUMPPEdzVJAh8Byx4uvnGZmTi3MyYx2A6gNAb4HmYBgu1%2F2HFvwMusj2W0IUz7jS44AW6j9hHwUpufUDCinMX7K8JyXAV7GtRJ6BxxkDMLZ%2Bkcj5HlhVUKJGgF5V0d4FEemCyYJuImv1MTef4T4YYefxWIMFlXeypw27kXdx7CCw%2BZSoF0nd6mW9ASgDVhByIO2PF8V8g6mJYuX0fUoJPjpscHGdCipZqC0V87FhbqL8fKuyUYD4asec7TjDfsAV5iv8B"></iframe>-->

					</p>
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify">
						StringData
					</p>
					<p align="justify">
						Bu header'ın belli kısımları yine LinkFlags'lere bağlı olarak kullanılır. Kısacası <code class="p_code" name="p_code">STRING_DATA</code> = <code class="p_code" name="p_code">[NAME_STRING]</code> <code class="p_code" name="p_code">[RELATIVE_PATH]</code> <code class="p_code" name="p_code">[WORKING_DIR]</code> <code class="p_code" name="p_code">[COMMAND_LINE_ARGUMENTS]</code> <code class="p_code" name="p_code">[ICON_LOCATION]</code> şeklindedir. StringData'nın kendi için bir flag değeri yoktur çünkü part part oluştuğu için bölümlerinin flag'leri vardır. Yani HasStringData gibi bir flag göremezsiniz. Aşağıda StringData'nın bölümleri anlatılırken hangi flag'lere ihtiyacı olduğu açıklanmıştır.            
					</p>
					<p align="justify">
						<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7Vxdd6I6FP01rjvz4CzkQ%2B2jVaqusepop52Zl66oKdAi8YZodX79TSAUEMbSO5UIVh8gJ%2BHr7HP2PkqgorSX2y4GK%2FMaLaBdkaXFtqJ0KrJck5QmXTDLzrdoTcU3GNha8EGhYWr9hsGW3Lq2FtCNDSQI2cRaxY1z5DhwTmI2gDF6jg97QHb8qCtgwIRhOgd20npnLYjpW5tyI7T3oGWYwZFr9Qu%2FZwbmTwZGa4cfryIrkvfxu5cg2Bc3uCZYoOeISdErShsjRPy15bYNbebbwG3%2Bdld%2F6H05bwwdkmWDO9i9HY%2FGlyNzrE%2Beft38sr%2F1q%2FwqXbIL%2FAEX1D28iTAxkYEcYOuh9dK7Zsj2KtFWOGaA0Ioaa9T4CAnZcazBmiBqMsnS5r1wa5EfbPMvGm%2F9jPR0tnzPXmMXNByCd5GNWPNntC%2FczGsF2z0gh1yBpWUzQw%2FaG0isOaAdLsHoCbaRjbB34cqVxL60J%2BlY7msXrfGcu%2Bn3bvJj1J6t7qRb9%2Fuss5naxqDa5KFBADYgOeB2vkPm68gROG5diJaQXgMdgKENiLWJhyrgEW%2B8jAtRpysc%2BPQgOHjaG2CvYRDMdZswL62AE4uP%2Br9rFrCeX6uuh3CLDqipq63nuqCfrhlsOe3pgwEdMOgPv9JFT2919Emwd3q2%2FgH8sYlYjEfas2kROF0BD4JnykbxqEoC6n3YuVq2HbFL3pdfQ3R8g30PBcAGYgK3BxHjvYqs%2BptwVlQUzW8%2FhxxT03j2mRF%2BUaW%2FB3kzbk7MxcC4enzcdpvd2%2BnD98vqRdkz%2FbWE3ku2VzP8UOK%2BnuBKTgl96CyPkc88j68Gre70%2FNJYDdRdWBrXtAS2eqWtVi6uIGa4Mc%2FTyGThbtlLq9LWaJcLhSZ%2FJPVDIkhP%2FlySWEkmcbqvpfTgePckTj26KrQ2q70BtBfGrsX4OqRvkYydFWxZKGMrb2fsue83xtbYmH2SNcoM9OBSdOWz50tpj9yXlBvWS7%2BLEiGpAtsyHL%2Fvce0S62Hnd4Y%2Fcap7R6vV%2FWOEy8%2BpctED7hAsYfmVQlMuYkqhyTkWfAdKkONUATH5n%2BHA%2FIV%2BktbzA19tiq72WV6WuEw4FcVJ9b2WtbzI60d%2FennR%2FCgvcgQ7t%2FLi0FmWsbyYcAeO2f%2BtRVCahKykBF72MqMuXGkaH0ojinzqWZVGFqo0Qv96LI3SZAVbrNIk687SKM0dwk%2BWY3QsfH46U5eE60zzQ2dEUU8jq86ILXIlkWCXRmeygi1WZ5JVZ2l0poWN9ZLC5p6hzKjCZSY5F%2BJDZnJinmZWmVGFykzy7no0QqQTjJDSaFPWCBGrTclKtTTa1J8jZ4Dm1InIOUN5En5fR1EKpzTS23jkHdkimGL8Ol00RNKFWisepvGpebVXMM1FG7Kj3RSJdnCax7gtP2xd6%2FfTm0l%2F2C0%2FOdeCQuzAjAtZlvMkZ614iSyOnFOm0p4iOcvFw%2FQUyTkz2mLJ%2BYgzpyf6oHXTv9Xvx62b3hnSc8qd6pzpWezDTgWjZ7kY9FzA30OnSM%2BZ0RZLz%2FLx6PluNPlK6%2Bb7Tn9yfuScdns3Z3IWOh2xaOSc%2BaEGseRcwN9Dp0jOmdEWS85HfN6gPbq%2Bbg0794P%2BUL9vTbrfr%2FXhTTGeP3xfnk65P5ovT6tCJ1nkwdP55LRaDAavFw%2FtU2TwzGiLZXD1eAzeb4%2BG94NRu3XTHw3PkLhT7hzmS9xyWR8xHfgvFgGu8w%2BbdUFMy6WLKcFsri4gwMeNlD%2Fm9u9WN4Q%2FGyKnEcqev10TrNjqfI3t3SWm4cAY8jXHhyix1oNtrXp83QYzaI%2BRa3lTFJQO9q%2FzkrnWmlMV2utfWouFJ1s8Qjs2fIiOb3HzyziMCODbVi%2BySMhfgSrvEYkqKSlEksT0xfj%2BoL7DFH%2F2bgOPPyIr6UTy5xcLRRI8W2YzHopHUQD5nIIB8UHQIT0lMPN2xZBdIYtN0KT71S4rWofti5Yx%2FmmnMIODHLhHCtz0HiESPIL18vRx8iUlF1IyRJSjpf3%2FmJz7NtjpiE8bgC2GyOfyM%2Ft%2BNdFopDC71MyT2ZNz3NrUvaRtAkrhNJncErlfDoQ0B%2FfTZvhKQK8v8t5FRf8P"></iframe>
					</p>
					<p align="justify">
						<b>NAME_STRING: </b><code class="p_code" name="p_code">HasName</code> bayrağına bağlı olarak kullanılır. LNK dosyasının comment'idir. Windows sistemlerinizde herhangi bir lnk dosyasının özelliklerine baktığınızda "Açıklama" veya "Comment" kısmındaki yazıyı içerisinde barındırır. Kullanıcılar istediği gibi bu kısmı değiştirebilir. 

					</p>
					<p align="justify">
						<b>RELATIVE_PATH: </b>LNK dosyasının hedefindeki dosyanın path'ini string değerinde saklar. <code class="p_code" name="p_code">HasRelativePath</code> bayrağına bağlıdır. Yine LNK özelliklerden bu kısmı değiştirebilirsiniz. 

					</p>
					<p align="justify">
						<b>WORKING_DIR: </b>LNK dosyasının başlangıç yeri/çalışma yeri adresini tutar. LNK özelliklerden "Başlama yeri"/"Start in" kısmından kullanıcılar istedikleri gibi değiştirebilirler. Bu yapı da <code class="p_code" name="p_code">HasWorkingDir</code> bayrağına bağlıdır.

					</p>
					<p align="justify">
						<b>COMMAND_LINE_ARGUMENTS: </b>LNK dosyası çalıştıracağı programa ek parametre/argüman verebilir. Vereceği parametreleri bu bölümde saklar. <code class="p_code" name="p_code">HasArguments</code> bayrağına bağlıdır. Aşağıda örnek olması açısından ne işe yaradığını bilmediğim bir parametre verdim (sadece parametre olarak algılamasını istediğim için).
					</p>
					<p align="justify">
						Parametre vermeden önceki lnk dosyasının görüntüsü
					</p>
					<p align="justify">
						<img style="width: 75%" src="..\images\16_10_2022\04.PNG">
					</p>
					<p align="justify">
						Parametre verdikten sonraki lnk dosyasının görüntüsü
					</p>
					<p align="justify">
						<img style="width: 50%" src="..\images\16_10_2022\06.PNG">
					</p>
					<p align="justify">
						<img style="width: 75%" src="..\images\16_10_2022\05.PNG">
					</p>
					<p align="justify">
						Bayrakları kontrol ettiğimizde HasArguments bayrağının 1 set edildiğini görüyoruz.
					</p>
					<p align="justify">
						<img style="width: 75%" src="..\images\16_10_2022\07.PNG">
					</p>
					<p align="justify">
						<b>ICON_LOCATION: </b>Lnk dosyasında kullanılan icon dosyasının nerede olduğunu tutar. Bu bölüm <code class="p_code" name="p_code">HasIconLocation</code> bayrağına bağlıdır. Bu kısım ancak hedef dosyanın icon dosyasını almazsa açılır. Yani lnk dosyasına kendimiz bir icon ayarlarsak, bu kısımda icon dosyanın adresi belirir. Yukarıda <code class="p_code" name="p_code">COMMAND_LINE_ARGUMENTS</code> için denediğimizi siz de bunda deneyebilirsiniz.
					</p>
					<p align="justify">
						Söylememe gerek var mı bilmiyorum ama yukarıdaki StringData bölümlerinin hepsi optional yapıdır. Aşağıdaki iki eleman ise her StringData bölümlerinin içerisinde bulunurlar.
					</p>
					<p align="justify">
						<b>String[variable]:</b> Bulunduğu bölümdeki karakter dizisini depolayan yapıdır.
					</p>
					<p align="justify">
						<b>CountCharacters[2]:</b> String yapısının kaç karakterden oluştuğunu belirten 2 byte'lık yapıdır.
					</p>
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify">
						ExtraData
					</p>
					<p align="justify">
						Bu kısım DFIR'ciler için olmazsa olmaz bir header diyebiliriz. Oldukça kapsamlı bir başlık olmasıyla beraber temelde 2 kısımdan oluşur. <code class="p_code" name="p_code">EXTRA_DATA</code> = <code class="p_code" name="p_code">*EXTRA_DATA_BLOCK</code> <code class="p_code" name="p_code">TERMINAL_BLOCK</code>
					</p>
					<p align="justify">
						<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7VtbV%2BI6FP41PMrqHXgEWrXLShEY1HlhRYjQY2lYISj46ydpU3pJRY4oMDDwYPPlQru%2FfctOLanN6fIKg9nkFo2gX1Kk0bKkmiVFkeWaTP8wZBUhelWNgDH2RnxQAnS9d8hBiaMLbwTnmYEEIZ94syw4REEAhySDAYzRW3bYM%2FKzvzoDYygA3SHwRfTeG5FJhFaVSoJfQ288iX9ZNmpRzxMYvowxWgT890qKKoWfqHsK4rU4MJ%2BAEXpLQapVUpsYIRJdTZdN6DPZxmKL5l1%2B0Lu%2BbwwDss2E91XnwW0%2Bze6l%2FvzXk%2Fna9cfORZU%2FzCvwF1wgTbfVdR1r0O647S6%2FdbKKxRU%2BMGRLSiW18TbxCOzOwJD1vlEFodiETH3akunlnGD0ApvIRzicrV6GH9rz7Pl%2BCpfCL8NRQNLjK%2BxLcfFh%2BfO%2FQkzgMgXxh7%2BCaAoJXtEhvFeTylL6wxfgaqspWtlQIugt0QOqzxE2SemAxhkFXPXG699KxE8vOAPFbNzDq37bbTfcSdvqvPzu%2Ffbv7AtZE%2BQNR1RbeRNhMkFjFADfStBGlpFkjIPQjPPwHyRkxU0PLAjKsgSXHnlIXT%2Bypco6b5lLvnLYWMWNgD7vQzKQNR%2FTfcm0sBXPY%2FxegqnnM%2BAa%2Bq%2BQeEOQI34En8HCJ4UKJLHvJoUgAI8h2SRk7p%2BYZDfqDYY%2BIN5r1k8Ucc6ntpFH7yXRN03JapihZ5eYowUeQj4rpznr29hKme4axK252l1N6TV%2FXVvvD327dREbiGjZl0dp3IIlF9D7VeM29mvchXwoAh9mvXNvt86MC106Ai5UgQur1bc7buvWavVOkZDY6cUkaEdAgiaQYFMPNThxJjaZRvUIWNEFVm5a7n1rcOk6ptU5M0aMPWeFhYwYAiOMBKvTexx0e27n3IK5cQzBvCJw0r22b8%2BMicoxhPKqyETbatp15zw9VuUYIrtYVOh16s2b8yPjGAJ6XGhLsdG3u736oN4yB%2FWG27cGtulQ5MzIqR5DbFfEnYhAwHwCZuxyuMD%2BqoHB8IXVNz5jIqGNtXzwBP02mnvEQwHFfPjM1mDi9YbAd3LdU280CotLwPfGDMCRLNYT6hxfD8SIAD65Jm1RudmJWFlT8zsaVdIEKuWayCTlslzRf4pNcUtjPVDXNzDr1N4ajtu8EdilUiBZ5mKZD6k0IN4odDj33sFTuBQT7YzVksKH0hsl3WRrLQhlNSz8ieYZoADmLDOGckb5jdxVKmUjR12lVmSIsi6J9Kk%2FZohVgZk9ll7j%2Bur%2FLb1KSrr4esH2%2BWvkgwps2GpD7FG5Me0yt7HWXK20sPAalTM3iZibXbpCu8GMdijI7qYJtUNqwj6K8EfGtnFQtsV6h7UkGJiAgBNKhdRc8kP3bgfOfDRR8B9mPlGIHKFFFOpkweA%2BoaIgwv1ofqLGZ75xhKOZaFGEqxVFuIpeVqs%2Fpe1iLalndW7tFt0uF6cnf6%2FK60aWhH2f8BZrvajkx55myJnQkkSaQwaXOA38NLioO8aWcGodY7BKDeBpdrJy7uRXqWU1z5D0tOJ8Ol439JyiRXfwrcfDqlgWuAZzaznrEuwF4xNyBGqc0W0%2BZpErBd74504gD7vfWBv%2FY6rnL8wy1YK3PooHKofMMuPbzJwXWI5DIcdu0agrXVt10%2BqcsNWpuphx7tnkDrqxOx2TU7Y1uV2D725sK4LJcVO7dOpXp1TmzlvaB4nuno1NLGxzuRvhm31PmF6N2VWZfk6YjQ%2Fed9ovG5osSPjftuMLrk%2Fb0vXtmmx8aduhShu3EZ%2BPV%2Fax7RCPSOi2wwT4zQts85T9QPHB%2FJ79gPrPD3yHH9i2tr3rQcbXyg%2FVXPlB%2B6T8kB8v7cMPiOXfqPxgD1Fwwm7ggzcK9%2BwGDvp%2FJqfjBowt3UBlRzewWyYu1vw7i%2BDeI5PuxJs6YAXxKdtb8dui32VvtJn8B1%2FkG5N%2Fk1StPw%3D%3D"></iframe>
					</p>
					<p align="justify">
						<b>EXTRA_DATA_BLOCK[variable]:</b> Extra Data başlığını oluşturan asıl kısım burasıdır ve 11 bölümden oluşur. Bu başlığı lnk dosyasının bir parçası olarak görmeyiniz. Sadece bir soyutlama olarak görünüz. Aslında tablo diye bir şey yok. Yani böyle bir tabloyu byte olarak lnk dosyasının içerisinde göremeyeceksiniz. Sadece 11 adet bölümlerini görebileceksiniz (yani başlangıç offseti 11 bölümden birisi olacaktır, tablo değil), her neyse. 
					</p>
					<p align="justify">
					Elbette 11 bölümün 11'ini de anlatmayacağım (evet tabiki.., belki, söz veremem :)). Ama meraklısı için tekrardan official <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">MS-SHELLINK</a> dökümantasyonunu buraya bırakıyorum. 
					</p>
					<p align="justify">
						<b>TERMINAL_BLOCK[4]:</b> Extra Data segmentinin bitişini belirtir. Bu kısmın saçma bir şekilde 0x4'ten küçük herhangi bir değerde olma zorunluluğu var (güya öyle. Ah MS ah..). Aşağıda ExtraData yapısını görebilirsiniz.
					</p>
					<p align="justify">
						Aşağıda ExtraData Tablosunun bölümleri kısaca açıklanmıştır. Önemli olan başlıklar detaylı bir şekilde üzerinde durulmaya çalışılmıştır.
					</p>
					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						1- ConsoleDataBlock (0xA0000002)
					</p>
					<p align="justify">
						Lnk dosyası, konsol penceresinde çalıştırılan bir uygulamayı belirttiğinde konsolda kullanılacak görüntü/renk/font (vb.) ayarlarını belirtir.
					</p>
					<p> Aşağıda örnek olarak zararlı bir LNK dosyasındaki ConsoleDataBlock yapısının veri dizilişi verilmiştir.</p>
					<p align="justify"><img src="..\images\16_10_2022\11.png" style="width: 60%"></p>

					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						2- ConsoleFEDataBlock (0xA0000004)
					</p>
					<p align="justify">
						Yukarıdaki veri yapısıyla benzer görevleri yapar fakat sadece kullanılacak karakter kodlamasını belirtir. 
					</p>
					
					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						3- DarwinDataBlock (0xA0000006)
					</p>
					<p align="justify">
						HasDarwinID bayrağı set edilmişse açılır. MSI dosyaları için etkinleştirilen bir bloktur. LNK dosyası aslında Windows Installer alt sistemini çağırıyor ve Windows Installer ise paketimizdeki belirli yürütülebilir dosyayı çağırıyor.
					</p>

					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						4- EnvironmentVariableDataBlock (0xA0000001)
					</p>
					<p align="justify">
						LNK dosyası için geliştirici tarafından verilen custom çevresel değişkenler barındırır.
					</p>

					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						5- IconEnvironmentDataBlock (0xA0000007)
					</p>
					<p align="justify">
						LNK dosyasına verilen icon dosyasının path'i bilinen klasörlerden geçiyorsa, icon dosyasının yolu çevre değişkenleriyle beraber tutulur (mesela %system%, %windir% vb. yollardan geçiyorsa)
					</p>
					<p align="justify">
						Örnek olması açısından aşağıdaki lnk dosyasının icon path'ine bakın:
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\12.png" style="width: 75%">
					</p>
					<p align="justify">
						Şimdi de IconEnvironmentData kısmına bakın
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\13.PNG" style="width: 75%">
					</p>
					<p align="justify">
						Buradaki amaç icon'un bulunabilmesi için path'te çevirmenlik yapılmak istenmesidir.
					</p>
					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						6- KnownFolderDataBlock (0xA000000B)
					</p>
					<p align="justify">
						LNK dosyası bilinen bir klasörü işaret ettiğinde, klasörün izini sürmek için kullanılabilir. Böylece LNK dosyasındaki IDList hedef bağlantılar (LinkTargetIDList yapısındaki) yüklendiğinde, bu blok içerisindeki veriler yardımcı bir çevirmenlik görevi görebilir.
					</p>
					<p align="justify">
						IconEnvironmentDataBlock için yaptığımızı burada da yapalım:
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\14.PNG" style="width: 75%">
					</p>
					<p align="justify">
						Bir de KnownFloderDataBlock'a bakın
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\15.PNG" style="width: 75%">
					</p>
					<p align="justify">
						Burada gördüğünüz <code class="p_code" name="p_code">{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}</code> alfanumerik dizisi Windows'un klasörler için atadığı özel kimlik kartı gibi düşünebiliriz demiştik. Google amcaya bu kimliği sorarsanız size MSDN'den ne olduğunu söyleyecektir.
					</p>
					<p align="justify">
						Şimdi örnek olması açısından aşağıdaki gibi kimlik adresin hangi klasörü işaret ettiği gösterilmiştir.
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\16.PNG" style="width: 50%">
					</p>
					<p align="justify">
						Diğer kimlik'ler (GUID) için: <a href="https://learn.microsoft.com/en-us/windows/win32/shell/knownfolderid#constants">tıkla</a>
					</p>
					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						7- PropertyStoreDataBlock (0xA0000009)
					</p>
					<p align="justify">
						Uygulamalar tarafından LNK dosyasında fazladan veri depolamak için kullanılabilecek bir dizi özellik belirtir. Bu kısmı metadata olarak düşünebilirsiniz.
					</p>

					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						8- ShimDataBlock (0xA0000008)
					</p>
					<p align="justify">
						<!-- -->
					</p>

					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						9- SpecialFolderDataBlock (0xA0000005)
					</p>
					<p align="justify">
						Bu yapının tam olarak ne işe yaradığından emin değilim ama sanırım <code class="p_code" name="p_code">KnownFloderDataBlock</code> yapısındaki kimliğin CSIDL'isni tutuyor. 
					</p>
					<p align="justify">
						<code class="p_code" name="p_code">CSIDL Equivalent</code> kısmında <code class="p_code" name="p_code">CSIDL_SYSTEM</code> belirtcini görüyorsunuz. Google amcada "CSIDL_SYSTEM" diye arattığımızda karşımıza çıkan kaynaklardan hangi ID'ye eşit olduğunu bulabilirsiniz. Örnek olması için aşağıda adım adım anlatılmıştır: 
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\17.PNG" style="width: 75%">
					</p>
					<p align="justify">
						SpecialFolderID değerinin decimal olarak 37 olduğunu görüyorsunuz. CSIDL listesinden arattığımızda
					</p>
					<p align="justify">
						<img src="..\images\16_10_2022\18.PNG" style="width: 75%">
					</p>
					<p align="justify">
						Diğer CSIDL değerlerine bakmak için: <a href="https://tarma.com/support/im9/using/symbols/functions/csidls.htm">tıkla</a>
					</p>
					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						10- TrackerDataBlock (0xA0000003)
					</p>
					<p align="justify">
						Bu kısmı çok detaylı görmekte fayda var. Çünkü Digital Forensic alanında çalışanlar için ilk bakılacak yerlerden birisi burasıdır. Aşağıda bu kısımla ilgili bir çizelge görebilirsiniz:
					</p>
					<p align="justify">
						<iframe width="100%" height="300" src="https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1#R7Zpbc6IwGIZ%2FjZfdgXBQL9dDD7Ntta3b2t7spJBC1kjcGDz012%2BAICDa7W63QKky45A3CcTn%2FRLMNzS07nR1wuDMvaA2Ig2g2KuG1msA0FKA%2BA6EdSQYLS0SHIbtSFIT4QY%2FIykqUvWxjeaZhpxSwvEsK1rU85DFMxpkjC6zzZ4oyd51Bh2UE24sSPLqHba5K38WaCb6KcKOG99ZNdtRzSO0Jg6jvifv1wCaEn6i6imMryWFuQttukxJWr%2BhdRmlPDqbrrqIBGhjbFG%2F4z21m3Ez5PHXdLhDJ7fDwbAzcIf968nD6IFcnR2puhwcX8dAkC34yCJl3KUO9SDpJ2on%2FNEouKwiSkmbc0pnQlSF%2BBNxvpZmQ59TIbl8SmQtWmE%2BTp3fB5f6YshSbyWvHBbWccHjbD1OGgbF%2B3Rd0i0sxf2eqMeP4RSTQDhFZIE4tqCs6FJCmdBt9AR9IjB25pzRCYp14emxEhyiJs9bWhAASwmS%2FgmiUyQGIhowRCDHi2zAQRm3zqbdpuuQYnELoMgpputyiskZpptG9hJz6jMLyV5JBIiT1DASKYyL3THybQb98Xz49dFHv0aLH5fT2XX%2FSG2WGSNJXNynav5vjPzJ9C2Hd0ZBZEIkXXX4oD3Qr9pg1P1%2B2n8e355dHgHpGofMQfwF3uYboyjj%2F1%2Bb3TqYXaTZzTLN3vycCpit%2FJPZ6ocy%2B63Ph7eZDQ5mF2k2KNVs7WB2kWZrpZpd6p%2F4z2e2XqrZxsHsIs02CjL7xVEuIPHlrUYMWhPEepDDDqHWJBcNWa%2BXLuboZgZDGEsGZ1lf86zDT7A9xoSkdCU8trbNQftmcLy0PV4gxtEqJeVhylpNUTMbXUOTqZNlkpgBMRI3lZTRlffaDeXwh8zDaVIp7jnIO6zYy72tZ7DrRh67GmexCsEO9mF3PMh9Vif2AFQNvpaDf448R4ylPtA1o2rQ9Rz0W8TmmHo1oq63qkY9%2F3S9gJaLPXTWqxF3U60ad7VCu9OPkWTcnyh%2BxV%2FY9u7wKCihXKHN6SfwWlXKNNvMLag9RkWP%2BiymqpldTE219MW0QgmBDzzBmq%2BdYKUm8VXzYHaRZpeaxG%2FuXk07mNVqN2boVVtS2%2FseY3GCqhbct9I%2BZqts7LHvO7iDGnHfTvlUAHw%2Bz5leaWoV9dtZiArQz6c7M%2FTrFPvbuYj3pC%2BKyduV0ctwyRusWv83"></iframe>
					</p>
					<p align="justify">
						<b>MachineID: </b>Bu bloğun ilk önemli kısmı, LNK dosyasının en son bulunuduğu makinenin NETBIOS ismini tutar. Nedir bu NETBIOS? diyecek olursanız, kısaca ağda bu makineyi hangi isimle tanıdığımızı belirten yapıdır.
					</p>
					<!--<p align="justify">
						<b>Droid: </b>Volume Droid ve File Droid adında iki kısma ayrılır. DROID (Digital Record Object Identification)
					</p>-->
					<p style="color: yellow; font-size: 20px; margin-bottom: -15px" align="justify">
						11- VistaAndAboveIDListDataBlock (0xA000000C)
					</p>
					<p align="justify">
						LinkTargetIDList yapısı yerine kullanılabilecek alternatif bir IDList belirtir.
					</p>
					<!--<p class="topic_sub_subject" name="topic_sub_subject" align="justify" id="NEDIR_BU_GUID_SID_CLSID_APPID_UUID">
						Nedir Bu GUID, CLSID, SID, APPID, UUID?
					</p>-->
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify" id="SHOW_COMMAND_VALUES">
						SHOW_COMMAND_VALUES
					</p>
					<p align="justify">
					<table cellspacing="0" style="margin: auto">
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-color: #DEDEDE;border-width:1">SW_SHOWNORMAL</td><td style="padding: 5;text-align: center;border-right-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">Hedefteki uygulamayı normal varsayılan pencere boyutunda açar</td></tr>
	<tr><td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">SW_SHOWMAXIMIZED</td><td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">Hedef uygulamanın penceresi max boyutlarda açılır</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">SW_SHOWMINNOACTIVE<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">Uygulamayı minimum (taskbar'da sembol olarak) olarak açar</td></tr>
</table>
</p>

					<p class="topic_sub_subject" name="topic_sub_subject" align="justify" id="LINK_FLAGS">
						LINK_FLAGS
					</p>
					<p align="justify">
<table cellspacing="0" style="margin: auto">
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-color: #DEDEDE;border-width:1">HasLinkTargetIDList</td><td style="padding: 5;text-align: center;border-right-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">LinkTargetIDList başlığının olup olmadığını belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasLinkInfo</td><td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">LinkInfo başlığının olup olmadığını belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasName<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">StringData bölümlerinden Name kısmının olup olmadığnı belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasRelativePath<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">StringData bölümlerinden RelativePath kısmının olup olmadığnı belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasWorkingDir<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">StringData bölümlerinden WorkingDir kısmının olup olmadığnı belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasArguments<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">StringData bölümlerinden CommandLineArguments kısmının olup olmadığnı belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasIconLocation<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">StringData bölümlerinden IconLocation kısmının olup olmadığnı belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">IsUnicode<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0" align="justify">StringData bölümleri için Unicode (UTF-16 little-endian) kodlaması kullanılıp kullanılmadığını belirtir. Eğer set edilmemişse sistem varsayılan karakter kodlama sistemini (win için ASCII) kullanır</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">ForceNoLinkInfo<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">Set edilmişse LinkInfo başlığı dikkate alınmaz</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasExpString<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">ExtraDataBlock bölümündeki EnvironmentVariableDataBlock olup olmadığını belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">RunInSeparateProcess<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasDarwinID<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">ExtraDataBlock bölümündeki DarwinDataBlock olup olmadığını belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">RunAsUser<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">Hedef uygulamayı farklı bir kullanıcıdan açılmak istenirse bu belirteç set edilir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">HasExpIcon<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">ExtraDataBlock bölümündeki IconEnvironmentDataBlock olup olmadığını belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">NoPidlAlias<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">RunWithShimLayer<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">ExtraDataBlock bölümündeki ShimDataBlock olup olmadığını belirtir</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">ForceNoLinkTrack<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0">Set edilmişse ExtraDataBlock bölümündeki TrackerBlock başlığı dikkate alınmaz</td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">EnableTargetMetadata<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">DisableLinkPathTracking<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">DisableKnownFolderTracking<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">DisableKnownFolderAlias<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">AllowLinkToLink<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">UnaliasOnSave<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">PreferEnvironmentPath<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">KeepLocalIDListForUNCTarget<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
</table>
</p>

					<p class="topic_sub_subject" name="topic_sub_subject" align="justify" id="FILE_ATTRIBUTE_FLAGS">
						FILE_ATTRIBUTE_FLAGS
					</p>
					<p align="justify">
<table cellspacing="0" style="margin: auto">
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_READONLY</td><td style="padding: 5;text-align: center;border-right-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA-->AAAAAAAA</td></tr>
	<tr><td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_HIDDEN</td><td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_SYSTEM<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_VOLUME_LABEL<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_DIRECTORY<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_ARCHIVE<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_NORMAL<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_TEMPORARY<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0" align="justify"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_SPARSE_FILE<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_REPARSE_POINT<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_COMPRESSED<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_OFFLINE<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_NOT_CONTENT_INDEXED<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_ENCRYPTED<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_INTEGRITY_STREAM<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_VIRTUAL<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>	
	<tr><td style="padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1">FILE_ATTRIBUTE_NO_SCRUB_DATA<td style="padding: 5;text-align: center;padding: 5;text-align: center;border-right-style:solid; border-top-style:solid; border-color: #DEDEDE;border-width:1;border-right-width: 0"><!--AAAAAAAA--></td></tr>
</table>
</p>
					<p class="topic_sub_subject" name="topic_sub_subject" align="justify" id="HOTKEY_FLAGS">
						HOTKEY_FLAGS
					</p>
					<p align="justify">
	Kısayol tuş bayrakları için <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943">MS-SHELLINK</a> official dökümanına bakınız.
	</p>
				</div>
			</div>
		</div>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-HG8JQ59PYY"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-HG8JQ59PYY');
	</script>
	</body>
</html>
